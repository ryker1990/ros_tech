{"version":3,"sources":["../lib/Database.js"],"names":["_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","Constructor","protoProps","staticProps","prototype","_mongodb","require","_awsSdk","_awsSdk2","_interopRequireDefault","_Config","_Config2","obj","__esModule","default","_classCallCheck","instance","TypeError","url","connectionTries","Database","this","connect","bind","start","savePreset","loadPresets","deletePreset","saveCurrentSession","loadCurrentSession","selectPreset","savePress","saveYield","loadPresses","sync","loadUnsyncedPresets","loadUnsyncedPresses","uploadPresets","markPresetsSynced","uploadPresses","markPressesSynced","loadWifiSetup","setWifiSetup","updateDeviceUiSettings","loadDeviceUiSettings","ddb","DynamoDB","AWS","value","machineID","that","Promise","resolve","reject","MongoClient","err","db","console","log","setTimeout","then","catch","uiSettings","_this","JSON","stringify","previous","collection","update","id","assign","upsert","findOne","result","close","isSet","wifiSetup","topTemp","bottomTemp","time","weight","material","bag","strainName","insert","selected","ops","find","toArray","presets","presetID","deleteOne","_id","ObjectId","state","sessions","current","$set","multi","session","date","Date","getTime","bagSize","notes","pressID","presses","yield","unsyncedPresets","unsyncedPresses","_this2","$exists","_this3","requests","map","preset","PutRequest","Item","S","String","BOOL","size","name","params","RequestItems","batchWriteItem","data","except","exceptIDs","UnprocessedItems","o","presetsArray","indexOf","_this4","press","pressesArray","module","exports"],"mappings":"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","file":"Database.js"}