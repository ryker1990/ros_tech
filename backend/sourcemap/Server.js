{"version":3,"sources":["../lib/Server.js"],"names":["_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","Constructor","protoProps","staticProps","prototype","_Constants","require","_Constants2","_interopRequireDefault","_Config","_Config2","_events","_events2","_socket","_socket2","_wifiControl","_wifiControl2","_dispatch","obj","__esModule","default","_classCallCheck","instance","TypeError","_possibleConstructorReturn","self","call","ReferenceError","_inherits","subClass","superClass","create","constructor","value","setPrototypeOf","__proto__","Server","_EventEmitter","this","_this","getPrototypeOf","start","bind","onConnect","onSwitchRelay","onSavePreset","onDeletePreset","onSelectPreset","onStartPress","onCancelPress","onSaveYield","onSetTopTemp","onSetBottomTemp","onSetTime","onConfirmCancel","onSessionState","onNetworkScan","onNetworkState","onNetworkConnect","onNetworkDisconnect","onGetPresses","onExportHistory","onClearExport","setDeviceUiSettings","dispatch","database","name","batcher","clients","socket","on","_this2","Promise","resolve","console","log","listen","client","id","init","debug","MSG_SWITCH_RELAY","MSG_SAVE_PRESET","MSG_DELETE_PRESET","MSG_SELECT_PRESET","MSG_START_PRESS","MSG_CANCEL_PRESS","MSG_SAVE_YIELD","MSG_SET_TOP_TEMP","MSG_SET_BOTTOM_TEMP","MSG_SET_TIME","MSG_CONFIG_CANCEL","MSG_NETWORK_CONNECT","MSG_NETWORK_DISCONNECT","MSG_NETWORK_SCAN","MSG_NETWORK_STATE","MSG_GET_PRESSES","MSG_EXPORT_HISTORY","MSG_CLEAR_EXPORT","MSG_SAVE_CURRENT_SESSION","onDisconnect","indexOf","push","emit","CLIENT_CONNECTED","index","splice","F_CONFIRM_CANCEL","topTemp","F_SET_TOP_TEMP","bottomTemp","F_SET_BOTTOM_TEMP","time","F_SET_TIME","weight","pressID","F_SAVE_YIELD","F_START_PRESS","F_CANCEL_PRESS","relayNumber","relayState","F_SWITCH_RELAY","material","bag","strainName","F_SAVE_PRESET","presetID","F_DELETE_PRESET","F_SELECT_PRESET","state","F_SAVE_CURRENT_SESSION","F_GET_PRESSES","emailAddress","F_EXPORT_HISTORY","F_CLEAR_EXPORT","_this3","scanForWiFi","err","response","result","networks","MSG_NETWORK_SCAN_RESULT","getIfaceState","_state","connection","NETWORK_STATE_CONNECTED","NETWORK_STATE_DISCONNECTED","_ssid","ssid","MSG_NETWORK_STATE_RESULT","password","_this4","NETWORK_STATE_CONNECTING","connectToAP","setWifiSetup","disconnect","success","msg","settings","updateDeviceUiSettings","message","object","module","exports"],"mappings":"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","file":"Server.js"}